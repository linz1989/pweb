require(["css!../../compressed/css/page/"+$$.rootVm.page+".css?"+$$.rootVm.currTime,"daterangepicker","!domReady"],function(){function e(e,t,c){s=e=e||1;var o=formatDateRangeVal(n.val()),d=t||o.start,u=c||o.end;$.ajax({url:"club/finacial/deal/list",data:{startDate:d,endDate:u,page:e,pageSize:i,businessCategory:l.selectType},success:function(t){200==t.statusCode&&(l.dataList=t.respData,a.refresh({currPage:e,totalPage:t.pageCount}),avalon.scan(r[0]))}})}var a,t=$$.rootVm.page+"Ctrl"+ +new Date,r=$("#"+$$.rootVm.page+"Page"),i=20,s=1,n=$("#dataListTable>table>thead>tr.search>th>div.time>input"),c=$("#dataListTable>table>thead>tr.search>th>div.time>a"),o={paid_order:"付费预约",paid_coupon:"点钟券",club_charge:"会所充值",coupon:"优惠券",direct_reward:"直接打赏",withdrawal:"提现",consume:"扫码支付",user_recharge:"用户充值"};r.attr("ms-controller",t),$$.currPath.html("结算中心 >> 结算记录"),avalon.filters.bizTypeFilter=function(e){return o[e]||""};var l=avalon.define({$id:t,dataList:[],selectType:"",switchType:function(){l.selectType=this.value,e()}}),d=new Date,u=new Date;d.setTime(d.getTime()-2592e6),n.daterangepicker({startDate:d,endDate:u},function(a,t){c.removeClass("active"),e(1,a.format("YYYY-MM-DD"),t.format("YYYY-MM-DD"))}),a=new Pagination($("#dataListPagination"),{switchPage:function(a){e(a)}}),$("#dataListTable>table>thead>tr:eq(0)>th>div>select").on("change",function(){i=this.value,e()}),c.click(function(){var a=$(this);if(!a.hasClass("active")){a.siblings().removeClass("active"),a.addClass("active");var t=a.attr("type");if("all"!=t){var r=new Date;r.setTime(r.getTime()-24*parseInt(t)*60*60*1e3),n.data("daterangepicker").setStartDate(r),n.data("daterangepicker").setEndDate(new Date)}else n.val("");e()}}),e()});