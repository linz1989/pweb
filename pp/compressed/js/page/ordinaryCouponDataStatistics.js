require(["css!../../compressed/css/page/dataStatistics.css?"+$$.rootVm.currTime,"daterangepicker","highcharts","!domReady"],function(){function t(){$.ajax({url:"club/datastatistics/redpacket_share_use_get_data_total",data:{actId:c.currSelectCouponId},success:function(t){200==t.statusCode&&t.respData&&(c.countObj=t.respData)}})}function a(t,a){var e=$("#chartGroup>div.tool>a.active").attr("type"),o=formatDateRangeVal(r.val()),i=t||o.start,n=a||o.end;$.ajax({url:"club/datastatistics/get_use_share_chart_data",data:{startDate:i,endDate:n,statisticsType:e,actId:c.currSelectCouponId},success:function(t){if(200==t.statusCode){t=t.respData;var a={xAxis:{categories:t.days,labels:{step:Math.round(t.days.length/10)<1?1:Math.round(t.days.length/10),staggerLines:1},tickmarkPlacement:"on"},series:t.highchartDataLst,yAxis:[{title:{text:null},min:0,allowDecimals:!1}],tooltip:{},colors:["#f5b156","#7cb5ec","#ff7d7d","#71c77b"]};$("#chartGroup>div.chart").updateChart(a),avalon.scan(s[0])}}})}var e=$$.rootVm.page+"Ctrl"+ +new Date,s=$("#"+$$.rootVm.page+"Page"),r=$("#chartGroup>div.tool>div>input");s.attr("ms-controller",e),$$.currPath.html("数据统计 >> 优惠券");var c=avalon.define({$id:e,currSelectCouponId:"",couponList:[],countObj:{openTotal:"-",getTotal:"-",haveUseTotal:"-",shareTotal:"-"},doChangeCoupon:function(){c.currSelectCouponId=this.value,t(),a()}}),o=new Date;o.setTime(o.getTime()-2592e6),r.daterangepicker({startDate:o,endDate:new Date},function(t,e){$("#chartGroup>div.tool>div>a").removeClass("active"),a(t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD"))}),$("#chartGroup>div.tool>a").click(function(){var t=$(this);t.hasClass("active")||(t.siblings().removeClass("active"),t.addClass("active"),a())}),$("#chartGroup>div.tool>div>a").click(function(){var t=$(this);if(!t.hasClass("active")){t.siblings().removeClass("active"),t.addClass("active");var e=new Date;e.setTime(e.getTime()-24*parseInt(t.attr("type"))*60*60*1e3),r.data("daterangepicker").setStartDate(e),r.data("daterangepicker").setEndDate(new Date),a()}}),$.ajax({url:"club/datastatistics/get_club_coupon_ids",success:function(t){200==t.statusCode&&(c.couponList=t.respData)}}),t(),a()});