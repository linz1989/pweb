require(["css!../../compressed/css/page/dataStatistics.css?"+$$.rootVm.currTime,"daterangepicker","highcharts","!domReady"],function(){function a(){$.ajax({url:"api/v2/manager/datastatistics/paid_order_count",data:{actId:o.currSelectCouponId},success:function(a){200==a.statusCode&&a.respData&&(o.countObj=a.respData)}})}function t(a,t){var e=$("#chartGroup>div.tool>a.active").attr("type"),i=formatDateRangeVal(s.val()),c=a||i.start,n=t||i.end;$.ajax({url:"api/v2/manager/datastatistics/paid_order/report",data:{startDate:c,endDate:n,type:e,actId:o.currSelectCouponId},success:function(a){if(200==a.statusCode){a=a.respData;var t={xAxis:{categories:a.days,labels:{step:Math.round(a.days.length/10)<1?1:Math.round(a.days.length/10),staggerLines:1},tickmarkPlacement:"on"},series:a.highchartDataLst,yAxis:[{title:{text:null},min:0,allowDecimals:!1}],tooltip:{},colors:["#f5b156","#7cb5ec","#ff7d7d"]};$("#chartGroup>div.chart").updateChart(t),avalon.scan(r[0])}}})}var e=$$.rootVm.page+"Ctrl"+ +new Date,r=$("#"+$$.rootVm.page+"Page"),s=$("#chartGroup>div.tool>div>input");r.attr("ms-controller",e),$$.currPath.html("数据统计 >> 付费预约");var o=avalon.define({paidOrderSwitch:"off",$id:e,countObj:{sumCount:"-",sumAmount:"-",completeCount:"-",completeAmount:"-",expireCount:"-",expireAmount:"-"}}),i=new Date;i.setTime(i.getTime()-2592e6),s.daterangepicker({startDate:i,endDate:new Date},function(a,e){$("#chartGroup>div.tool>div>a").removeClass("active"),t(a.format("YYYY-MM-DD"),e.format("YYYY-MM-DD"))}),$("#chartGroup>div.tool>a").click(function(){var a=$(this);a.hasClass("active")||(a.siblings().removeClass("active"),a.addClass("active"),t())}),$("#chartGroup>div.tool>div>a").click(function(){var a=$(this);if(!a.hasClass("active")){a.siblings().removeClass("active"),a.addClass("active");var e=new Date;e.setTime(e.getTime()-24*parseInt(a.attr("type"))*60*60*1e3),s.data("daterangepicker").setStartDate(e),s.data("daterangepicker").setEndDate(new Date),t()}}),$.ajax({url:"api/v2/manager/paid_order/open_status",success:function(e){200==e.statusCode&&(e=e.respData,"on"==e.openStatus&&"Y"==e.payAppointment?(o.paidOrderSwitch="on",a(),t()):avalon.scan(r[0]))}})});