require(["css!../../compressed/css/page/dataStatistics.css?"+$$.rootVm.currTime,"daterangepicker","highcharts","!domReady"],function(){function t(){$.ajax({url:"club/credit/account",success:function(t){200==t.statusCode&&t.respData&&(t=t.respData,c.deliverAmount=t.deliverAmount,c.recycleAmount=t.recycleAmount)}})}function a(t,a){var e=$("#chartGroup>div.tool>a.active").attr("type"),c=formatDateRangeVal(s.val()),i=t||c.start,o=a||c.end;$.ajax({url:"club/credit/trade/statistics",data:{startDate:i,endDate:o,clubId:$$.clubId,accumulated:"total"==e},success:function(t){if(200==t.statusCode){t=t.respData;var a={xAxis:{categories:t.days,labels:{step:Math.round(t.days.length/10)<1?1:Math.round(t.days.length/10),staggerLines:1},tickmarkPlacement:"on"},series:t.data,yAxis:[{title:{text:null},min:0,allowDecimals:!1}],tooltip:{},colors:["#f5b156","#7cb5ec"]};$("#chartGroup>div.chart").updateChart(a),avalon.scan(r[0])}}})}var e=$$.rootVm.page+"Ctrl"+ +new Date,r=$("#"+$$.rootVm.page+"Page"),s=$("#chartGroup>div.tool>div>input");r.attr("ms-controller",e),$$.currPath.html("数据统计 >> 积分统计");var c=avalon.define({$id:e,deliverAmount:0,recycleAmount:0}),i=new Date;i.setTime(i.getTime()-2592e6),s.daterangepicker({startDate:i,endDate:new Date},function(t,e){$("#chartGroup>div.tool>div>a").removeClass("active"),a(t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD"))}),$("#chartGroup>div.tool>a").click(function(){var t=$(this);t.hasClass("active")||(t.siblings().removeClass("active"),t.addClass("active"),a())}),$("#chartGroup>div.tool>div>a").click(function(){var t=$(this);if(!t.hasClass("active")){t.siblings().removeClass("active"),t.addClass("active");var e=new Date;e.setTime(e.getTime()-24*parseInt(t.attr("type"))*60*60*1e3),s.data("daterangepicker").setStartDate(e),s.data("daterangepicker").setEndDate(new Date),a()}}),t(),a()});