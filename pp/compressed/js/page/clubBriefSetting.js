require(["css!../../compressed/css/page/"+$$.rootVm.page+".css?"+$$.rootVm.currTime,"dragsort","!domReady"],function(){function e(){$.ajax({url:"club/item/data",success:function(e){200==e.statusCode&&(i.list=e.respData),avalon.scan(s[0])}})}var t,o=$$.rootVm.page+"Ctrl"+ +new Date,s=$("#"+$$.rootVm.page+"Page");s.attr("ms-controller",o),$$.currPath.html("资料设置 >> 会所简介");var i=avalon.define({$id:o,list:[],confirmContent:"",opeType:"",opeId:"",doClickDelMenu:function(e){i.confirmContent="确认删除此简介？",i.opeType="delete",i.opeId=e,t.show()},doClickOfAddNew:function(){$.ajax({url:"club/item/info/-1",success:function(e){e&&e.id?location.href="#!/clubBriefDetail?id="+e.id+"&ope=add":msgAlert(e.msg||e.message||"数据请求异常！")}})},doClickEditMenu:function(e){location.href="#!/clubBriefDetail?id="+e+"&ope=edit"}});t=new Modal($("#confirmModal"),{doClickOkBtn:function(){$.ajax({url:"club/item/delete/"+i.opeId,dataType:"text",success:function(o,s){t.close(),"success"==s?(msgAlert("删除成功！",!0),e()):msgAlert(o.msg||o.message||"删除失败！")}})}}),$("#briefItemList").dragsort({dragSelector:"li",dragSelectorExclude:"div>ul>li",dragEnd:function(){for(var e=$(this),t=e.parents("ul").children(),o=[],s=0;s<t.length;s++)o.push(t[s].getAttribute("itemId"));$.ajax({url:"club/item/sort",type:"post",data:{ids:o.join(",")},success:function(e){200==e.statusCode&&msgAlert("操作成功！",!0)}})}}),e()});