require(["css!../../compressed/css/page/"+$$.rootVm.page+".css?"+$$.rootVm.currTime,"daterangepicker","!domReady"],function(){function a(a,t){var r=formatDateRangeVal(s.val()),n=a||r.start,o=t||r.end;$.ajax({url:"club/datastatistics/paidcoupon/index",data:{startDate:n,endDate:o,actId:c.selectCouponId},success:function(a){200==a.statusCode&&(a=a.respData,c.dataList=a.records,c.countObj=a,avalon.scan(e[0]))}})}var t=$$.rootVm.page+"Ctrl"+ +new Date,e=$("#"+$$.rootVm.page+"Page"),s=$("#dataListTable>table>thead>tr.search>th>div.time>input"),r=$("#dataListTable>table>thead>tr.search>th>div.time>a");e.attr("ms-controller",t),$$.currPath.html("数据统计 >> 点钟券");var c=avalon.define({$id:t,dataList:[],selectCouponId:"",couponSelectData:[],countObj:{},switchCoupon:function(){c.selectCouponId=this.value,a()}}),n=new Date,o=new Date;n.setTime(n.getTime()-2592e6),s.daterangepicker({startDate:n,endDate:o},function(t,e){r.removeClass("active"),a(t.format("YYYY-MM-DD"),e.format("YYYY-MM-DD"))}),$.ajax({url:"api/v2/club/paidcoupons",success:function(a){200==a.statusCode?c.couponSelectData=a.respData:a.msg&&msgAlert(a.msg)}}),r.click(function(){var t=$(this);if(!t.hasClass("active")){t.siblings().removeClass("active"),t.addClass("active");var e=t.attr("type");if("all"!=e){var r=new Date;r.setTime(r.getTime()-24*parseInt(e)*60*60*1e3),s.data("daterangepicker").setStartDate(r),s.data("daterangepicker").setEndDate(new Date)}else s.val("");a()}}),a()});