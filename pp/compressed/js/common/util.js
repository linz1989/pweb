function Modal(e,t){this.ele=e,this.option=t=t||{};var i=this,a=this.ele.find("div>h3.header>span"),o=this.ele.find("div>div.footer>a.cancel"),s=this.ele.find("div>div.footer>a.ok");a[0]&&a.click(function(){i.close()}),s[0]&&t.doClickOkBtn&&s.click(function(){t.doClickOkBtn()}),o[0]&&(t.doClickCancelBtn?o.click(function(){t.doClickCancelBtn()}):o.click(function(){i.close()})),this.tip=this.ele.find("div>div.footer>span.tip"),this.ele.children("div").append("<div class='mask'><div><i></i><i></i><i></i><i></i><i></i></div></div>")}function Pagination(e,t){this.ele=e,this.option=t||{},this.pages=e.children("div.pages");var i=this;i.pages.on("click","a",function(){if(!/disable/.test(this.className)&&"..."!=this.innerHTML){var e=1;/curr/.test(this.className)||(e=/prev/.test(this.className)?i.currPage-1:/next/.test(this.className)?i.currPage+1:parseInt(this.innerHTML),i.option.switchPage(e))}})}function getParamObj(e){var t={},i=location.href.split("?")[1];if(i){i=i.split("&");var a,o;for(a=0;a<i.length;a++)o=i[a].split("="),2==o.length&&(t[o[0]]=o[1])}return e?t[e]:t}function formatDateRangeVal(e){var t=e.split(" - ");return t[0]=t[0]||"",t[1]=t[1]||"",t[0]=t[0].slice(0,-1).replace(/(年|月)/g,"-"),t[1]=t[1].slice(0,-1).replace(/(年|月)/g,"-"),{start:t[0],end:t[1]}}function formatDate(e){var t=e.getMonth()+1,i=e.getDate(),a=e.getHours(),o=e.getMinutes(),s=e.getSeconds();return a=a>9?a:"0"+a,o=o>9?o:"0"+o,s=s<10?"0"+s:s,e.getFullYear()+"-"+(t<9?"0"+t:t)+"-"+(i<9?"0"+i:i)+" "+a+":"+o+":"+s}function msgAlert(e,t,i){i=i||2e3,t=t?"success":"fail";var a=$('<div class="msgBox"><span><span class="'+t+'"></span>'+e+'<span class="end"></span></span></div>');$("body").append(a),a.show(0),setTimeout(function(){a.remove()},i)}function inArr(e,t,i){for(var a=0;a<t.length;a++)if(i){if(t[a][i]==e)return!0}else if(t[a]==e)return!0;return!1}function iCropper(e){if(e=e||{},this.option=e,this.cropper=null,this.cropperStatus="enable",this.hasCrop=!0,this.loadOption={},!this.option.imgFile)return void console.log("iCropper --- 选项中不存在imgFile!");this.option.maxSize=e.maxSize||10240,this.option.fileNameMaxLength=e.fileNameMaxLength||50,this.option.ratioW=this.option.ratioW||1,this.option.ratioH=this.option.ratioH||1,this.option.$img=$(this.option.img);var t=this,i=this.option;window.URL=window.URL||window.webkitURL,$(i.imgFile).on("change",function(){if(i.imgFile.files[0]){var e=i.imgFile.value,a=e.lastIndexOf("."),o=e.substr(a+1).toLowerCase(),s=e.substr(0,a).toLowerCase();if(!/^(jpg|png|jpeg)$/.test(o))return i.imgFile.value="",i.imgName.value="",msgAlert("请上传后缀名为jpg或png的照片！"),!1;if(s.length>=i.fileNameMaxLength)return i.imgFile.value="",i.imgName.value="",msgAlert("图片文件名不能超过"+i.fileNameMaxLength+"字符"),!1;var r=i.imgFile.files[0].size;if(r=Math.round(r/1024*100)/100,r>=i.maxSize){var n;return n=i.maxSize>=1024?Math.round(i.maxSize/1024)+"MB":Math.round(i.maxSize)+"KB",i.imgFile.value="",i.imgName.value="",msgAlert("照片最大尺寸为"+n+"，请重新上传!"),!1}i.imgName.value=i.imgFile.files[0].name;var l=URL.createObjectURL(i.imgFile.files[0]);t.load(l,{blobURL:l})}})}function iSessionStorage(e,t){if(sessionStorage&&sessionStorage.setItem&&sessionStorage.getItem){if(void 0==t)return sessionStorage.getItem(e);sessionStorage.setItem(e,t)}return!1}String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},Modal.prototype.show=function(e){e&&this.ele.find("div>div.content").html(e),this.ele.css("display","block"),this.ele.removeClass("loading");var t=this.ele;setTimeout(function(){t.addClass("active")},30)},Modal.prototype.close=function(){this.ele.removeClass("active");var e=this.ele;setTimeout(function(){e.css("display","none")},500),this.option.afterClose&&this.option.afterClose()},Modal.prototype.loading=function(e){e=e||"show","show"==e?this.ele.addClass("loading"):this.ele.removeClass("loading")},Modal.prototype.showTip=function(e,t){if(this.tip&&this.tip[0]){e&&this.tip.text(e),t===!0?this.tip.addClass("ok"):this.tip.removeClass("ok"),this.tip.show();var i=this.tip;setTimeout(function(){i.hide()},3e3)}},Modal.prototype.hideClose=function(){this.ele.find("div>h3.header>span").hide()},Pagination.prototype.refresh=function(e){this.currPage=e.currPage,this.totalPage=e.totalPage;var t,i=1!=e.currPage,a=e.currPage!=e.totalPage,o="<a class='prev"+(i?"":" disable")+"'><<</a>";if(e.totalPage<=7)for(t=1;t<=e.totalPage;t++)o+="<a"+(t==this.currPage?" class='curr'":"")+">"+t+"</a>";else{var s=[1,,,,,,e.totalPage],r=e.currPage-1,n=e.currPage+1;if(r<3){for(t=1;t<=4;t++)s[t]=t+1;s[5]="..."}else if(e.totalPage-n<3){for(t=5;t>=2;t--)s[t]=s[t+1]-1;s[1]="..."}else s[1]="...",s[2]=r,s[3]=e.currPage,s[4]=n,s[5]="...";for(t=0;t<s.length;t++)o+="<a"+(s[t]==e.currPage?" class='curr'":"")+">"+s[t]+"</a>"}o+="<a class='next"+(a?"":" disable")+"'>>></a>",this.pages.html(o)},$.fn.updateChart=function(e){e=e||{},e=$.extend(!0,{title:{text:""},subtitle:{text:""},width:["1px"],exporting:{enabled:!1},credits:{enabled:!1}},e);var t=$(this).highcharts();if(t){t.xAxis[0].update(e.xAxis);for(var i=t.series;i.length>0;)i[0].remove(!1);for(var a=0;a<e.series.length;a++)t.addSeries(e.series[a],!1);t.redraw()}else $(this).highcharts(e)},iCropper.prototype.load=function(e,t){var i=this,a=this.option;i.loadOption=t||{},i.loadOption.autoCropArea=i.loadOption.autoCropArea||1,a.img.src=e,i.cropper?(i.changeCropperStatus("enable"),a.$img.cropper("reset").cropper("replace",e)):(i.cropper=!0,a.$img.cropper({aspectRatio:a.ratioW/a.ratioH,autoCrop:!0,checkCrossOrigin:!1,autoCropArea:i.loadOption.autoCropArea,built:function(){i.loadOption.disabled===!0?i.changeCropperStatus("disable"):i.changeCropperStatus("enable"),i.loadOption.blobURL?(URL.revokeObjectURL(i.loadOption.blobURL),a.imgId&&(a.imgId.value="")):(a.imgFile.value="",a.imgName.value="")},crop:function(e){i.setSelectValue(e)}})),a.onImgLoad&&a.onImgLoad()},iCropper.prototype.setSelectValue=function(e){var t=this.option;t.x.value=Math.round(e.x)||0,t.y.value=Math.round(e.y)||0,t.w.value=Math.round(e.width)||0,t.h.value=Math.round(e.height)||0,t.selectionTxt&&(0!=t.w.value&&0!=t.h.value?(t.selectionTxt.innerHTML="<b>x："+t.x.value+"</b><b>y："+t.y.value+"</b><b>宽："+t.w.value+"px</b><b>高："+t.h.value+"px</b>",t.selectionTxt.style.display="inline"):t.selectionTxt.style.display="none")},iCropper.prototype.clean=function(){this.cropper&&(this.option.$img.cropper("destroy"),this.option.selectionTxt&&(this.option.selectionTxt.style.display="none"),this.option.img.src="",this.cropper=!1)},iCropper.prototype.checkSelectionValidate=function(){var e=this.option,t=parseInt(e.x.value),i=parseInt(e.y.value),a=parseInt(e.w.value),o=parseInt(e.h.value);if(0==e.x.value.length||0==e.y.value.length||0==e.w.value.length||0==e.h.value.length)return"您未选择区域！";if(t<0||i<0)return"您的选择区域有问题！";var s=e.$img.cropper("getImageData");return t+a>s.naturalWidth||i+o>s.naturalHeight?"您的选择区域有问题！":"OK"},iCropper.prototype.changeCropperStatus=function(e){var t="enable"==e?"disable":"enable";this.cropperStatus==t&&(this.option.$img.cropper(e),this.cropperStatus=e)};