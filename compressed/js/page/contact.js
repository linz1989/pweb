function Modal(i,t){this.ele=i,this.option=t=t||{};var e=this,s=this.ele.find("div>h3.header>span"),o=this.ele.find("div>div.footer>a.cancel"),a=this.ele.find("div>div.footer>a.ok");s[0]&&s.click(function(){e.close()}),a[0]&&t.doClickOkBtn&&a.click(function(){t.doClickOkBtn()}),o[0]&&(t.doClickCancelBtn?o.click(function(){t.doClickCancelBtn()}):o.click(function(){e.close()})),this.tip=this.ele.find("div>div.footer>span.tip"),this.ele.children("div").append("<div class='mask'><div><i></i><i></i><i></i><i></i><i></i></div></div>")}function msgAlert(i,t,e){e=e||2e3,t=t?"success":"fail";var s=$('<div class="msgBox"><span><span class="'+t+'"></span>'+i+'<span class="end"></span></span></div>');$("body").append(s),s.show(0),setTimeout(function(){s.remove()},e)}Modal.prototype.show=function(i){i&&this.ele.find("div>div.content").html(i),this.ele.css("display","block"),this.ele.removeClass("loading");var t=this.ele;setTimeout(function(){t.addClass("active")},30)},Modal.prototype.close=function(){this.ele.removeClass("active");var i=this.ele;setTimeout(function(){i.css("display","none")},500),this.option.afterClose&&this.option.afterClose()},Modal.prototype.loading=function(i){i=i||"show","show"==i?this.ele.addClass("loading"):this.ele.removeClass("loading")},Modal.prototype.showTip=function(i,t){if(this.tip&&this.tip[0]){i&&this.tip.text(i),t===!0?this.tip.addClass("ok"):this.tip.removeClass("ok"),this.tip.show();var e=this.tip;setTimeout(function(){e.hide()},3e3)}},Modal.prototype.hideClose=function(){this.ele.find("div>h3.header>span").hide()},$(function(){function i(){return t.val()?e.val()&&!/^([\.a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/.test(e.val())?(e.focus(),h.showTip(d),!1):o.val()?!!a.text()||(a.focus(),!1):(o.focus(),!1):(t.focus(),!1)}var t=$("#user-name"),e=$("#user-email"),s=$("#user-tel"),o=$("#user-subject"),a=$("#user-content"),n=$("#contact-modal"),l=n.attr("success-tip"),c=n.attr("fail-tip"),d=e.attr("email-error-tip"),h=new Modal(n,{doClickOkBtn:function(){if(i()){h.loading();var n=+new Date,d=SHA1("A6925251770173UZ35E25FEA-86D2-D271-C6CB-68EEC80020B2UZ"+n)+"."+n;$.ajax({url:"https://d.apicloud.com/mcm/api/customer",method:"POST",cache:!1,headers:{"X-APICloud-AppId":"A6925251770173","X-APICloud-AppKey":d},data:{name:t.val(),email:e.val(),tel:s.val(),subject:o.val(),content:a.text()}}).success(function(i,n,c){h.loading("hide"),t.val(""),e.val(""),s.val(""),o.val(""),a.html(""),h.close(),msgAlert(l,!0)}).fail(function(i,t,e){msgAlert(c)})}}});$("#contact_building_btn,#contact_support_btn").click(function(){h.show()}),s.on("input",function(){/[^+\d]/.test(this.value)&&(this.value=this.value.replace(/[^+\d]/g,""))}),$("#loading").removeClass("active")});