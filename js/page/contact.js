function Modal(t,i){this.ele=t,this.option=i=i||{};var e=this,s=this.ele.find("div>h3.header>span"),o=this.ele.find("div>div.footer>a.cancel"),a=this.ele.find("div>div.footer>a.ok");s[0]&&s.click(function(){e.close()}),a[0]&&i.doClickOkBtn&&a.click(function(){i.doClickOkBtn()}),o[0]&&(i.doClickCancelBtn?o.click(function(){i.doClickCancelBtn()}):o.click(function(){e.close()})),this.tip=this.ele.find("div>div.footer>span.tip"),this.ele.children("div").append("<div class='mask'><div><i></i><i></i><i></i><i></i><i></i></div></div>")}function msgAlert(t,i,e){e=e||2e3,i=i?"success":"fail";var s=$('<div class="msgBox"><span><span class="'+i+'"></span>'+t+'<span class="end"></span></span></div>');$("body").append(s),s.show(0),setTimeout(function(){s.remove()},e)}Modal.prototype.show=function(t){t&&this.ele.find("div>div.content").html(t),this.ele.css("display","block"),this.ele.removeClass("loading");var i=this.ele;setTimeout(function(){i.addClass("active")},30)},Modal.prototype.close=function(){this.ele.removeClass("active");var t=this.ele;setTimeout(function(){t.css("display","none")},500),this.option.afterClose&&this.option.afterClose()},Modal.prototype.loading=function(t){t=t||"show","show"==t?this.ele.addClass("loading"):this.ele.removeClass("loading")},Modal.prototype.showTip=function(t,i){if(this.tip&&this.tip[0]){t&&this.tip.text(t),i===!0?this.tip.addClass("ok"):this.tip.removeClass("ok"),this.tip.show();var e=this.tip;setTimeout(function(){e.hide()},3e3)}},Modal.prototype.hideClose=function(){this.ele.find("div>h3.header>span").hide()},$(function(){function t(){return i.val()?e.val()&&!/^([\.a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/.test(e.val())?(e.focus(),h.showTip(d),!1):o.val()?!!a.text()||(a.focus(),!1):(o.focus(),!1):(i.focus(),!1)}var i=$("#user-name"),e=$("#user-email"),s=$("#user-tel"),o=$("#user-subject"),a=$("#user-content"),n=$("#contact-modal"),l=n.attr("success-tip"),c=n.attr("fail-tip"),d=e.attr("email-error-tip"),h=new Modal(n,{doClickOkBtn:function(){if(t()){h.loading();var n=+new Date,d=SHA1("A6925251770173UZ35E25FEA-86D2-D271-C6CB-68EEC80020B2UZ"+n)+"."+n;$.ajax({url:"https://d.apicloud.com/mcm/api/customer",method:"POST",cache:!1,headers:{"X-APICloud-AppId":"A6925251770173","X-APICloud-AppKey":d},data:{name:i.val(),email:e.val(),tel:s.val(),subject:o.val(),content:a.text()}}).success(function(t,n,c){h.loading("hide"),i.val(""),e.val(""),s.val(""),o.val(""),a.html(""),h.close(),msgAlert(l,!0)}).fail(function(t,i,e){msgAlert(c)})}}});$("#contact_building_btn,#contact_support_btn").click(function(){h.show()}),s.on("input",function(){/[^+\d]/.test(this.value)&&(this.value=this.value.replace(/[^+\d]/g,""))})});